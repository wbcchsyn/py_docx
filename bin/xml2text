#!/usr/bin/env python3
# -*- python -*-

import argparse
import sys

from docx import xml2text


def parse_args(args: list[str]) -> argparse.Namespace:
    parser = argparse.ArgumentParser("Strip metadata and extract text from a XML file.")
    parser.add_argument(
        "--input",
        type=str,
        default="-",
        help="""Path to the xml file to be extracted the text. If "-", read from stdin. The default is "-".""",
    )
    parser.add_argument(
        "--output",
        type=str,
        default="-",
        help="""Path to the output to be written. If "-", write into stdout. The default is "-".""",
    )
    return parser.parse_args(args)


if __name__ == "__main__":

    args = parse_args(sys.argv[1:])

    if args.input == "-":
        xml = sys.stdin.read()
    else:
        xml = open(args.input).read()

    text = xml2text(xml)

    if args.output == "-":
        sys.stdout.write(text)
    else:
        open(args.output, "w").write(text)
